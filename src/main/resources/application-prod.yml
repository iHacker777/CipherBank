spring:
  application:
    name: cipherbank

  # ============================================================================
  # DUAL DATABASE CONFIGURATION
  # ============================================================================

  datasource:
    security:
      driver-class-name: com.mysql.cj.jdbc.Driver
      jdbc-url: jdbc:mysql://34.180.14.173:3306/paytrix_db?serverTimezone=UTC&allowPublicKeyRetrieval=true
      username: root
      password: password
      hikari:
        connection-timeout: 30000
        maximum-pool-size: 10
        minimum-idle: 5
        idle-timeout: 600000
        max-lifetime: 1800000
        pool-name: SecurityHikariPool

    business:
      driver-class-name: com.mysql.cj.jdbc.Driver
      jdbc-url: jdbc:mysql://34.180.14.173:3306/cipherbank?serverTimezone=UTC&allowPublicKeyRetrieval=true
      username: root
      password: password
      hikari:
        connection-timeout: 30000
        maximum-pool-size: 20
        minimum-idle: 10
        idle-timeout: 600000
        max-lifetime: 1800000
        pool-name: BusinessHikariPool

  # ============================================================================
  # JPA CONFIGURATION
  # ============================================================================
  jpa:
    security:
      show-sql: true
      format-sql: true
      hibernate:
        ddl-auto: update
        dialect: org.hibernate.dialect.MySQLDialect
        naming:
          physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
          implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
      properties:
        hibernate:
          dialect: org.hibernate.dialect.MySQLDialect
          format_sql: true
          use_sql_comments: true
          jdbc:
            batch_size: 20
            fetch_size: 50
          order_inserts: true
          order_updates: true

    business:
      show-sql: true
      format-sql: true
      hibernate:
        ddl-auto: update
        dialect: org.hibernate.dialect.MySQLDialect
        naming:
          physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
          implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
      properties:
        hibernate:
          dialect: org.hibernate.dialect.MySQLDialect
          format_sql: true
          use_sql_comments: true
          jdbc:
            batch_size: 20
            fetch_size: 50
          order_inserts: true
          order_updates: true

  # ============================================================================
  # FILE UPLOAD CONFIGURATION
  # ============================================================================
  servlet:
    multipart:
      enabled: true
      max-file-size: 10MB
      max-request-size: 10MB
      file-size-threshold: 0
      location: /tmp

  kafka:
    bootstrap-servers: localhost:9092

    producer:
      retries: 10  # More retries in production
      properties:
        request.timeout.ms: 30000
        delivery.timeout.ms: 120000

    consumer:
      properties:
        session.timeout.ms: 45000
        heartbeat.interval.ms: 15000
        max.poll.interval.ms: 300000  # 5 minutes

kafka:
  topics:
    statements-uploaded:
      replication-factor: 3  # Full replication
    statements-processed:
      replication-factor: 3
    statements-dlq:
      replication-factor: 3

# ============================================================================
# SWAGGER/OPENAPI CONFIGURATION
# ============================================================================
springdoc:
  api-docs:
    enabled: true
  swagger-ui:
    enabled: true
    path: /swagger-ui.html

# ============================================================================
# JWT CONFIGURATION
# ============================================================================
jwt:
  secret: secret-key1234-secret-key1234-admin
  encryption-secret: 3f7a9c1d2b4e5f8091a2b3c4d5e6f701
  expiration: 900000

# ============================================================================
# IP WHITELIST SECURITY CONFIGURATION
# ============================================================================
security:
  ip-whitelist:
    enabled: true
    debug: true      # Enable detailed IP logging in production for debugging

# ============================================================================
# STATEMENT QUERY CONFIGURATION
# ============================================================================
statement:
  # Query pagination and sorting configuration
  query:
    max-page-size: 100          # Maximum records per page
    default-page-size: 20       # Default when not specified
    default-sort-column: transactionDateTime
    default-sort-direction: desc

  # Role-based column visibility configuration
  columns:
    visibility:
      # ROLE_ADMIN: Full access to all columns
      admin:
        - id
        - transactionDateTime
        - amount
        - balance
        - orderId
        - reference
        - payIn
        - accountNo
        - utr
        - gatewayTransactionId
        - uploadTimestamp
        - approvalStatus
        - processed
        - type
        - uploadId
        - uploadUsername
        - bankName
        - bankParserKey

      # ROLE_USER: Limited access to non-sensitive columns
      user:
        - transactionDateTime
        - amount
        - orderId
        - reference
        - payIn
        - utr
        - uploadTimestamp
        - bankName

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
logging:
  level:
    root: INFO
    com.paytrix.cipherbank.infrastructure.adapter.out.persistence.repository.security: DEBUG
    com.paytrix.cipherbank.infrastructure.adapter.out.persistence.adapter.security: DEBUG
    com.paytrix.cipherbank.infrastructure.adapter.out.persistence.repository.business: DEBUG
    com.paytrix.cipherbank.infrastructure.adapter.out.persistence.adapter.business: DEBUG
    org.hibernate.SQL: DEBUG
    com.paytrix.cipherbank: INFO
    com.zaxxer.hikari.HikariConfig: DEBUG
    com.zaxxer.hikari.HikariDataSource: INFO
    org.apache.kafka: WARN
    org.springframework.kafka: WARN
    com.paytrix.cipherbank.infrastructure.adapter.out.kafka: INFO
    com.paytrix.cipherbank.infrastructure.adapter.in.kafka: INFO